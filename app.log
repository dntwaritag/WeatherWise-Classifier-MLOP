2025-04-05 03:54:11,904 - src.app.main - INFO - Starting model retraining
2025-04-05 03:54:15,147 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-05 03:54:15,326 - src.app.main - INFO - Starting model training
2025-04-05 03:54:16,760 - src.app.main - ERROR - Retraining failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 269, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-05 03:55:00,565 - src.app.main - INFO - Starting bulk prediction
2025-04-05 03:55:00,714 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-05 03:55:01,493 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-05 03:55:16,504 - src.app.main - INFO - Starting training data upload
2025-04-05 03:55:20,181 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-05 03:55:27,386 - src.app.main - INFO - Starting bulk prediction
2025-04-05 03:55:27,468 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-05 03:55:27,987 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-05 03:55:34,118 - src.app.main - INFO - Starting model retraining
2025-04-05 03:55:37,285 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-05 03:55:37,350 - src.app.main - INFO - Starting model training
2025-04-05 03:55:38,668 - src.app.main - ERROR - Retraining failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 269, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-05 04:08:40,205 - src.app.main - INFO - Starting training data upload
2025-04-05 04:08:44,102 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-05 04:09:02,810 - src.app.main - INFO - Starting single prediction
2025-04-05 04:09:03,173 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-05 04:09:03,702 - src.app.main - INFO - Successfully completed single prediction
2025-04-05 04:09:43,906 - src.app.main - INFO - Starting bulk prediction
2025-04-05 04:09:44,027 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-05 04:09:44,740 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-05 04:10:12,087 - src.app.main - INFO - Starting model retraining process
2025-04-05 04:10:12,088 - src.app.main - INFO - Fetching training data from database
2025-04-05 04:10:15,396 - src.app.main - INFO - Successfully fetched 18993 records from database
2025-04-05 04:10:15,397 - src.app.main - INFO - Preprocessing data
2025-04-05 04:10:15,476 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-05 04:10:15,490 - src.app.main - INFO - Data preprocessed. Shapes - X_train: (33330, 8), X_test: (3799, 8)
2025-04-05 04:10:15,491 - src.app.main - INFO - Initializing new neural network model
2025-04-05 04:10:15,537 - src.app.main - INFO - Starting model training
2025-04-05 04:10:16,987 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 295, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-05 04:17:24,853 - src.app.main - INFO - Root endpoint accessed
2025-04-05 04:17:52,851 - src.app.main - INFO - Starting model retraining process
2025-04-05 04:17:52,851 - src.app.main - INFO - Fetching training data from database
2025-04-05 04:17:56,373 - src.app.main - INFO - Successfully fetched 18993 records from database
2025-04-05 04:17:56,373 - src.app.main - INFO - Preprocessing data
2025-04-05 04:17:56,420 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-05 04:17:56,428 - src.app.main - INFO - Data preprocessed. Shapes - X_train: (33330, 8), X_test: (3799, 8)
2025-04-05 04:17:56,428 - src.app.main - INFO - Validating data types and ranges
2025-04-05 04:17:56,432 - src.app.main - INFO - Initializing new neural network model
2025-04-05 04:17:56,433 - src.app.main - INFO - Number of classes detected: 5
2025-04-05 04:17:56,614 - src.app.main - INFO - Starting model training
2025-04-05 04:17:57,907 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 330, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-05 05:00:28,541 - src.app.main - INFO - Root endpoint accessed
2025-04-05 05:00:47,027 - src.app.main - INFO - Starting model retraining process
2025-04-05 05:00:47,027 - src.app.main - INFO - Fetching training data from database
2025-04-05 05:00:50,646 - src.app.main - INFO - Successfully fetched 18993 records from database
2025-04-05 05:00:50,646 - src.app.main - INFO - Preprocessing data
2025-04-05 05:00:50,712 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-05 05:00:50,721 - src.app.main - INFO - Data preprocessed. Shapes - X_train: (33330, 8), X_test: (3799, 8)
2025-04-05 05:00:50,722 - src.app.main - INFO - Validating data types and ranges
2025-04-05 05:00:50,724 - src.app.main - INFO - Initializing new neural network model
2025-04-05 05:00:50,726 - src.app.main - INFO - Number of classes detected: 5
2025-04-05 05:00:51,019 - src.app.main - INFO - Starting model training
2025-04-05 05:00:52,639 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 330, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-05 12:08:12,924 - src.app.main - INFO - Starting training data upload
2025-04-05 12:08:17,851 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-05 12:09:25,345 - src.app.main - INFO - Starting single prediction
2025-04-05 12:09:26,009 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-05 12:09:26,834 - src.app.main - INFO - Successfully completed single prediction
2025-04-05 12:10:02,645 - src.app.main - INFO - Starting bulk prediction
2025-04-05 12:10:02,776 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-05 12:10:03,667 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-05 12:10:38,652 - src.app.main - INFO - Starting model retraining process
2025-04-05 12:10:38,652 - src.app.main - INFO - Fetching training data from database
2025-04-05 12:10:42,592 - src.app.main - INFO - Successfully fetched 20454 records from database
2025-04-05 12:10:42,592 - src.app.main - INFO - Preprocessing data
2025-04-05 12:10:42,667 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-05 12:10:42,682 - src.app.main - INFO - Data preprocessed. Shapes - X_train: (35895, 8), X_test: (4091, 8)
2025-04-05 12:10:42,683 - src.app.main - INFO - Validating data types and ranges
2025-04-05 12:10:42,687 - src.app.main - INFO - Initializing new neural network model
2025-04-05 12:10:42,688 - src.app.main - INFO - Number of classes detected: 5
2025-04-05 12:10:42,768 - src.app.main - INFO - Starting model training
2025-04-05 12:10:44,428 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 330, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 02:38:45,657 - src.app.main - INFO - Root endpoint accessed
2025-04-06 02:39:28,980 - src.app.main - INFO - Starting model retraining process
2025-04-06 02:39:28,983 - src.app.main - INFO - Fetching training data from database
2025-04-06 02:39:36,341 - src.app.main - INFO - Successfully fetched 20454 records from database
2025-04-06 02:39:36,342 - src.app.main - INFO - Preprocessing data
2025-04-06 02:39:36,466 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 02:39:36,494 - src.app.main - INFO - Data preprocessed. Shapes - X_train: (35895, 8), X_test: (4091, 8)
2025-04-06 02:39:36,495 - src.app.main - INFO - Validating data types and ranges
2025-04-06 02:39:36,503 - src.app.main - INFO - Initializing new neural network model
2025-04-06 02:39:36,507 - src.app.main - INFO - Number of classes detected: 5
2025-04-06 02:39:37,076 - src.app.main - INFO - Starting model training
2025-04-06 02:39:41,280 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 330, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 03:22:35,853 - src.app.main - INFO - Root endpoint accessed
2025-04-06 03:23:39,731 - src.app.main - INFO - Starting training data upload
2025-04-06 03:23:44,593 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-06 03:23:54,508 - src.app.main - INFO - Starting single prediction
2025-04-06 03:23:55,006 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-06 03:23:55,946 - src.app.main - INFO - Successfully completed single prediction
2025-04-06 03:24:30,406 - src.app.main - INFO - Starting bulk prediction
2025-04-06 03:24:30,621 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-06 03:24:31,726 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 03:24:55,036 - src.app.main - INFO - Starting model retraining process
2025-04-06 03:24:55,037 - src.app.main - INFO - Fetching training data from database
2025-04-06 03:24:59,506 - src.app.main - INFO - Successfully fetched 21915 records from database
2025-04-06 03:24:59,507 - src.app.main - INFO - Preprocessing data
2025-04-06 03:24:59,598 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 03:24:59,619 - src.app.main - INFO - Data preprocessed. Shapes - X_train: (38460, 8), X_test: (4383, 8)
2025-04-06 03:24:59,620 - src.app.main - INFO - Validating data types and ranges
2025-04-06 03:24:59,626 - src.app.main - INFO - Initializing new neural network model
2025-04-06 03:24:59,630 - src.app.main - INFO - Number of classes detected: 5
2025-04-06 03:24:59,750 - src.app.main - INFO - Starting model training
2025-04-06 03:25:01,760 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 330, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 03:44:37,736 - src.app.main - INFO - Root endpoint accessed
2025-04-06 03:45:08,729 - src.app.main - INFO - Starting training data upload
2025-04-06 03:45:12,587 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-06 03:45:27,723 - src.app.main - INFO - Starting single prediction
2025-04-06 03:45:28,348 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-06 03:45:29,062 - src.app.main - INFO - Successfully completed single prediction
2025-04-06 03:46:01,199 - src.app.main - INFO - Starting bulk prediction
2025-04-06 03:46:01,309 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-06 03:46:01,936 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 03:46:19,197 - src.app.main - INFO - Starting model retraining process
2025-04-06 03:46:29,435 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 03:46:30,857 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 273, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 03:57:37,981 - src.app.main - INFO - Root endpoint accessed
2025-04-06 04:01:13,048 - src.app.main - INFO - Starting bulk prediction
2025-04-06 04:01:13,653 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-06 04:01:14,618 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 04:01:25,996 - src.app.main - INFO - Starting model retraining process
2025-04-06 04:01:29,962 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 04:01:31,684 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 273, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 04:46:46,074 - src.app.main - INFO - Root endpoint accessed
2025-04-06 04:47:18,722 - src.app.main - INFO - Starting model retraining process
2025-04-06 04:47:22,384 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 04:47:22,400 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 04:47:22,400 - src.app.main - INFO - X_train shape: (41025, 8), dtype: float32
2025-04-06 04:47:22,401 - src.app.main - INFO - y_train shape: (41025,), dtype: int32
2025-04-06 04:47:22,403 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 04:47:22,404 - src.app.main - INFO - X_train min/max: -3.07204008102417, 7.999026775360107
2025-04-06 04:47:22,404 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 04:47:24,563 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 279, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 04:49:54,736 - src.app.main - INFO - Starting bulk prediction
2025-04-06 04:49:55,149 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-06 04:49:56,191 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 04:50:04,967 - src.app.main - INFO - Starting model retraining process
2025-04-06 04:50:09,488 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 04:50:09,507 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 04:50:09,508 - src.app.main - INFO - X_train shape: (41025, 8), dtype: float32
2025-04-06 04:50:09,508 - src.app.main - INFO - y_train shape: (41025,), dtype: int32
2025-04-06 04:50:09,510 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 04:50:09,511 - src.app.main - INFO - X_train min/max: -3.07204008102417, 7.999026775360107
2025-04-06 04:50:09,511 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 04:50:11,049 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 279, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 04:55:21,318 - src.app.main - INFO - Starting model retraining process
2025-04-06 04:55:25,029 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 04:55:25,045 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 04:55:25,046 - src.app.main - INFO - X_train shape: (41025, 8), dtype: float32
2025-04-06 04:55:25,046 - src.app.main - INFO - y_train shape: (41025,), dtype: int32
2025-04-06 04:55:25,047 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 04:55:25,048 - src.app.main - INFO - Number of classes: 5
2025-04-06 04:55:25,049 - src.app.main - INFO - X_train min/max: -3.07204008102417, 7.999026775360107
2025-04-06 04:55:25,049 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 04:55:29,049 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-04-06 04:55:31,362 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 296, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 05:48:23,091 - src.app.main - INFO - Root endpoint accessed
2025-04-06 05:48:41,819 - src.app.main - INFO - Starting model retraining process
2025-04-06 05:48:45,329 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 05:48:45,346 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 05:48:45,346 - src.app.main - INFO - X_train shape: (41025, 8), dtype: float32
2025-04-06 05:48:45,347 - src.app.main - INFO - y_train shape: (41025,), dtype: int32
2025-04-06 05:48:45,349 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 05:48:45,350 - src.app.main - INFO - Number of classes: 5
2025-04-06 05:48:45,351 - src.app.main - INFO - X_train min/max: -3.0607669353485107, 5.0
2025-04-06 05:48:45,351 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 05:48:46,573 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-04-06 05:48:48,613 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 296, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 06:14:47,909 - src.app.main - INFO - Starting model retraining process
2025-04-06 06:14:51,348 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 06:14:51,349 - src.app.main - INFO - Raw data shape: (23376, 5)
2025-04-06 06:14:51,349 - src.app.main - INFO - Columns in data: ['precipitation', 'temp_max', 'temp_min', 'wind', 'weather']
2025-04-06 06:14:51,362 - src.app.main - INFO - Class distribution:
weather
rain       10256
sun        10240
fog         1616
drizzle      848
snow         416
Name: count, dtype: int64
2025-04-06 06:14:51,443 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 06:14:52,986 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-04-06 06:14:55,514 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 311, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 06:14:55,577 - src.app.main - ERROR - HTTP Error during retraining: Model training failed: Python int too large to convert to C long
2025-04-06 06:17:14,811 - src.app.main - INFO - Starting model retraining process
2025-04-06 06:17:18,420 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 06:17:18,432 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 06:17:18,433 - src.app.main - INFO - X_train shape: (41025, 8), dtype: float32
2025-04-06 06:17:18,434 - src.app.main - INFO - y_train shape: (41025,), dtype: int32
2025-04-06 06:17:18,435 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 06:17:18,436 - src.app.main - INFO - Number of classes: 5
2025-04-06 06:17:18,437 - src.app.main - INFO - X_train min/max: -3.0607669353485107, 5.0
2025-04-06 06:17:18,438 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 06:17:20,074 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-04-06 06:17:22,131 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 296, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 15:47:10,060 - src.app.main - INFO - Root endpoint accessed
2025-04-06 15:47:42,734 - src.app.main - INFO - Starting training data upload
2025-04-06 15:47:46,627 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-06 15:47:56,104 - src.app.main - INFO - Starting single prediction
2025-04-06 15:47:56,513 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-06 15:47:57,132 - src.app.main - INFO - Successfully completed single prediction
2025-04-06 15:49:30,364 - src.app.main - INFO - Starting bulk prediction
2025-04-06 15:49:30,461 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-04-06 15:49:31,176 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 15:49:52,890 - src.app.main - INFO - Starting model retraining process
2025-04-06 15:49:56,773 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 15:49:56,792 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 15:49:56,793 - src.app.main - INFO - X_train shape: (43585, 8), dtype: float32
2025-04-06 15:49:56,794 - src.app.main - INFO - y_train shape: (43585,), dtype: int32
2025-04-06 15:49:56,796 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 15:49:56,797 - src.app.main - INFO - Number of classes: 5
2025-04-06 15:49:56,798 - src.app.main - INFO - X_train min/max: -3.067516803741455, 5.0
2025-04-06 15:49:56,799 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 15:49:58,692 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-04-06 15:50:00,249 - src.app.main - ERROR - Model training failed: Python int too large to convert to C long
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 296, in retrain_model
    history = model.fit(
              ^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend\tensorflow\numpy.py", line 2079, in signbit
    tf.constant(0x80000000, dtype=tf.int32),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OverflowError: Python int too large to convert to C long
2025-04-06 16:19:53,867 - src.app.main - INFO - Root endpoint accessed
2025-04-06 16:20:25,393 - src.app.main - INFO - Root endpoint accessed
2025-04-06 16:20:41,726 - src.app.main - INFO - Starting model retraining process
2025-04-06 16:20:46,929 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 16:20:46,947 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 16:20:46,948 - src.app.main - INFO - X_train shape: (43585, 8), dtype: float32
2025-04-06 16:20:46,948 - src.app.main - INFO - y_train shape: (43585,), dtype: int32
2025-04-06 16:20:46,951 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 16:20:46,953 - src.app.main - INFO - Number of classes: 5
2025-04-06 16:20:46,954 - src.app.main - INFO - X_train min/max: -3.067516803741455, 5.0
2025-04-06 16:20:46,957 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 16:23:14,861 - src.app.main - ERROR - Unexpected error: Target is multiclass but average='binary'. Please choose another average setting, one of [None, 'micro', 'macro', 'weighted'].
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 310, in retrain_model
    metrics = evaluate_model(model, X_test, y_test)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\model.py", line 45, in evaluate_model
    'precision': round(float(precision_score(y_test, y_pred, zero_division=0)), 4),
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\sklearn\utils\_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\sklearn\metrics\_classification.py", line 2182, in precision_score
    p, _, _, _ = precision_recall_fscore_support(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\sklearn\utils\_param_validation.py", line 186, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\sklearn\metrics\_classification.py", line 1767, in precision_recall_fscore_support
    labels = _check_set_wise_labels(y_true, y_pred, average, labels, pos_label)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\sklearn\metrics\_classification.py", line 1556, in _check_set_wise_labels
    raise ValueError(
ValueError: Target is multiclass but average='binary'. Please choose another average setting, one of [None, 'micro', 'macro', 'weighted'].
2025-04-06 16:42:22,238 - src.app.main - INFO - Root endpoint accessed
2025-04-06 16:42:37,537 - src.app.main - INFO - Starting model retraining process
2025-04-06 16:42:54,444 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 16:42:54,454 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 16:42:54,454 - src.app.main - INFO - X_train shape: (43585, 8), dtype: float32
2025-04-06 16:42:54,455 - src.app.main - INFO - y_train shape: (43585,), dtype: int32
2025-04-06 16:42:54,455 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 16:42:54,456 - src.app.main - INFO - Number of classes: 5
2025-04-06 16:42:54,457 - src.app.main - INFO - X_train min/max: -3.067516803741455, 5.0
2025-04-06 16:42:54,457 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 16:45:54,404 - root - INFO - 
Model Evaluation:
2025-04-06 16:45:54,405 - root - INFO - Accuracy: 0.9575
2025-04-06 16:45:54,405 - root - INFO - Precision: 0.8989
2025-04-06 16:45:54,405 - root - INFO - Recall: 0.9806
2025-04-06 16:45:54,405 - root - INFO - F1 Score: 0.9346
2025-04-06 16:45:54,406 - root - INFO - Confusion Matrix:
[[2097   71    7    0    5]
 [   4 2048   68   56    0]
 [   0    0  344    0    0]
 [   0    0    0  180    0]
 [   0    0    0    0   88]]
2025-04-06 16:45:54,507 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 16:45:54,511 - src.app.main - ERROR - Unexpected error: 1 validation error for MetricDetail
confusion_matrix
  value is not a valid dict (type=type_error.dict)
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 321, in retrain_model
    metrics=MetricDetail(**metrics),
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "pydantic\main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for MetricDetail
confusion_matrix
  value is not a valid dict (type=type_error.dict)
2025-04-06 17:11:20,696 - src.app.main - INFO - Starting training data upload
2025-04-06 17:11:24,934 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-06 17:11:34,805 - src.app.main - INFO - Starting single prediction
2025-04-06 17:11:36,194 - src.app.main - INFO - Successfully completed single prediction
2025-04-06 17:12:09,562 - src.app.main - INFO - Starting bulk prediction
2025-04-06 17:12:10,539 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 17:12:30,407 - src.app.main - INFO - Starting model retraining process
2025-04-06 17:12:34,670 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 17:12:34,693 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 17:12:34,694 - src.app.main - INFO - X_train shape: (46150, 8), dtype: float32
2025-04-06 17:12:34,694 - src.app.main - INFO - y_train shape: (46150,), dtype: int32
2025-04-06 17:12:34,696 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 17:12:34,698 - src.app.main - INFO - Number of classes: 5
2025-04-06 17:12:34,700 - src.app.main - INFO - X_train min/max: -3.0706639289855957, 5.0
2025-04-06 17:12:34,700 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 17:16:20,400 - root - INFO - 
Model Evaluation:
2025-04-06 17:16:20,400 - root - INFO - Accuracy: 0.9721
2025-04-06 17:16:20,400 - root - INFO - Precision: 0.9309
2025-04-06 17:16:20,401 - root - INFO - Recall: 0.9873
2025-04-06 17:16:20,401 - root - INFO - F1 Score: 0.9568
2025-04-06 17:16:20,401 - root - INFO - Confusion Matrix:
[[2235   57   12    0    4]
 [   0 2230   38   36    0]
 [   0    0  364    0    0]
 [   0    0    0  191    0]
 [   0    0    0    0   93]]
2025-04-06 17:16:20,446 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 17:16:20,446 - src.app.main - ERROR - Unexpected error: name 'raw_metrics' is not defined
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 325, in retrain_model
    accuracy=raw_metrics["accuracy"],
             ^^^^^^^^^^^
NameError: name 'raw_metrics' is not defined
2025-04-06 17:27:48,461 - src.app.main - INFO - Starting model retraining process
2025-04-06 17:27:53,712 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 17:27:53,721 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 17:27:53,722 - src.app.main - INFO - X_train shape: (46150, 8), dtype: float32
2025-04-06 17:27:53,722 - src.app.main - INFO - y_train shape: (46150,), dtype: int32
2025-04-06 17:27:53,724 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 17:27:53,725 - src.app.main - INFO - Number of classes: 5
2025-04-06 17:27:53,726 - src.app.main - INFO - X_train min/max: -3.0706639289855957, 5.0
2025-04-06 17:27:53,726 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 17:31:18,957 - root - INFO - 
Model Evaluation:
2025-04-06 17:31:18,957 - root - INFO - Accuracy: 0.9663
2025-04-06 17:31:18,958 - root - INFO - Precision: 0.928
2025-04-06 17:31:18,958 - root - INFO - Recall: 0.9846
2025-04-06 17:31:18,958 - root - INFO - F1 Score: 0.9532
2025-04-06 17:31:18,959 - root - INFO - Confusion Matrix:
[[2231   65   12    0    0]
 [  11 2204   42   47    0]
 [   0    0  364    0    0]
 [   0    0    0  191    0]
 [   0    0    0    0   93]]
2025-04-06 17:31:19,054 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 17:31:19,060 - src.app.main - ERROR - Unexpected error: 1 validation error for MetricDetail
confusion_matrix
  value is not a valid dict (type=type_error.dict)
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 430, in retrain_model
    metrics=MetricDetail(
            ^^^^^^^^^^^^^
  File "pydantic\main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for MetricDetail
confusion_matrix
  value is not a valid dict (type=type_error.dict)
2025-04-06 17:51:43,726 - src.app.main - INFO - Root endpoint accessed
2025-04-06 17:58:07,359 - src.app.main - INFO - Starting training data upload
2025-04-06 17:58:11,693 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-06 17:58:21,068 - src.app.main - INFO - Starting single prediction
2025-04-06 17:58:24,617 - src.app.main - INFO - Successfully completed single prediction
2025-04-06 17:59:07,144 - src.app.main - INFO - Starting bulk prediction
2025-04-06 17:59:08,351 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 17:59:24,475 - src.app.main - INFO - Starting model retraining process
2025-04-06 17:59:28,570 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 17:59:28,584 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 17:59:28,584 - src.app.main - INFO - X_train shape: (48715, 8), dtype: float32
2025-04-06 17:59:28,584 - src.app.main - INFO - y_train shape: (48715,), dtype: int32
2025-04-06 17:59:28,586 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 17:59:28,587 - src.app.main - INFO - Number of classes: 5
2025-04-06 17:59:28,589 - src.app.main - INFO - X_train min/max: -3.074867010116577, 5.0
2025-04-06 17:59:28,589 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 18:03:16,249 - root - INFO - 
Model Evaluation:
2025-04-06 18:03:16,250 - root - INFO - Accuracy: Ellipsis
2025-04-06 18:03:16,250 - root - INFO - Precision: Ellipsis
2025-04-06 18:03:16,251 - src.app.main - ERROR - Unexpected error: 'recall'
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 428, in retrain_model
    metrics = evaluate_model(model, X_test, y_test)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\model.py", line 103, in evaluate_model
    logging.info(f"Recall: {metrics['recall']}")
                            ~~~~~~~^^^^^^^^^^
KeyError: 'recall'
2025-04-06 18:10:18,979 - src.app.main - INFO - Starting model retraining process
2025-04-06 18:10:23,121 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 18:10:23,144 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 18:10:23,176 - src.app.main - INFO - X_train shape: (48715, 8), dtype: float32
2025-04-06 18:10:23,182 - src.app.main - INFO - y_train shape: (48715,), dtype: int32
2025-04-06 18:10:23,189 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 18:10:23,194 - src.app.main - INFO - Number of classes: 5
2025-04-06 18:10:23,195 - src.app.main - INFO - X_train min/max: -3.074867010116577, 5.0
2025-04-06 18:10:23,196 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 18:14:10,531 - root - INFO - 
Model Evaluation:
2025-04-06 18:14:10,531 - root - INFO - Accuracy: 0.9728
2025-04-06 18:14:10,532 - root - INFO - Precision: 0.9359
2025-04-06 18:14:10,532 - root - INFO - Recall: 0.9876
2025-04-06 18:14:10,532 - root - INFO - F1 Score: 0.9592
2025-04-06 18:14:10,532 - root - INFO - Confusion Matrix:
[[2380   51    5    0    0]
 [   4 2337   48   43    0]
 [   0    0  384    0    0]
 [   0    0    0  201    0]
 [   0    0    0    0   99]]
2025-04-06 18:14:10,576 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 18:14:10,577 - src.app.main - ERROR - Unexpected error: name 'VALID_WEATHER_TYPES' is not defined
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 446, in retrain_model
    labels=list(VALID_WEATHER_TYPES.keys())  # ['rain', 'sun', 'fog', 'drizzle', 'snow']
                ^^^^^^^^^^^^^^^^^^^
NameError: name 'VALID_WEATHER_TYPES' is not defined
2025-04-06 18:17:51,008 - src.app.main - INFO - Starting model retraining process
2025-04-06 18:17:55,616 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 18:17:55,625 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 18:17:55,626 - src.app.main - INFO - X_train shape: (48715, 8), dtype: float32
2025-04-06 18:17:55,626 - src.app.main - INFO - y_train shape: (48715,), dtype: int32
2025-04-06 18:17:55,627 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 18:17:55,629 - src.app.main - INFO - Number of classes: 5
2025-04-06 18:17:55,630 - src.app.main - INFO - X_train min/max: -3.074867010116577, 5.0
2025-04-06 18:17:55,631 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 18:21:38,018 - root - INFO - 
Model Evaluation:
2025-04-06 18:21:38,018 - root - INFO - Accuracy: 0.9687
2025-04-06 18:21:38,018 - root - INFO - Precision: 0.9344
2025-04-06 18:21:38,018 - root - INFO - Recall: 0.9857
2025-04-06 18:21:38,019 - root - INFO - F1 Score: 0.9576
2025-04-06 18:21:38,019 - root - INFO - Confusion Matrix:
[[2351   70   15    0    0]
 [   0 2343   55   34    0]
 [   0    0  384    0    0]
 [   0    0    0  201    0]
 [   0    0    0    0   99]]
2025-04-06 18:21:38,085 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 18:21:38,088 - src.app.main - ERROR - Unexpected error: 4 validation errors for ConfusionMatrix
true_negative
  field required (type=value_error.missing)
false_positive
  field required (type=value_error.missing)
false_negative
  field required (type=value_error.missing)
true_positive
  field required (type=value_error.missing)
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 445, in retrain_model
    confusion_matrix=ConfusionMatrix(
                     ^^^^^^^^^^^^^^^^
  File "pydantic\main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 4 validation errors for ConfusionMatrix
true_negative
  field required (type=value_error.missing)
false_positive
  field required (type=value_error.missing)
false_negative
  field required (type=value_error.missing)
true_positive
  field required (type=value_error.missing)
2025-04-06 18:26:16,484 - src.app.main - INFO - Starting model retraining process
2025-04-06 18:26:20,837 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 18:26:20,851 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 18:26:20,851 - src.app.main - INFO - X_train shape: (48715, 8), dtype: float32
2025-04-06 18:26:20,851 - src.app.main - INFO - y_train shape: (48715,), dtype: int32
2025-04-06 18:26:20,853 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 18:26:20,855 - src.app.main - INFO - Number of classes: 5
2025-04-06 18:26:20,856 - src.app.main - INFO - X_train min/max: -3.074867010116577, 5.0
2025-04-06 18:26:20,856 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 18:30:06,141 - root - INFO - 
Model Evaluation:
2025-04-06 18:30:06,142 - root - INFO - Accuracy: 0.9679
2025-04-06 18:30:06,142 - root - INFO - Precision: 0.9327
2025-04-06 18:30:06,142 - root - INFO - Recall: 0.9854
2025-04-06 18:30:06,142 - root - INFO - F1 Score: 0.9569
2025-04-06 18:30:06,142 - root - INFO - Confusion Matrix:
[[2348   80    5    0    3]
 [   5 2342   51   34    0]
 [   0    0  384    0    0]
 [   0    0    0  201    0]
 [   0    0    0    0   99]]
2025-04-06 18:30:06,234 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 18:30:06,236 - src.app.main - ERROR - Unexpected error: 4 validation errors for ConfusionMatrix
true_negative
  field required (type=value_error.missing)
false_positive
  field required (type=value_error.missing)
false_negative
  field required (type=value_error.missing)
true_positive
  field required (type=value_error.missing)
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 446, in retrain_model
    confusion_matrix=ConfusionMatrix(
                     ^^^^^^^^^^^^^^^^
  File "pydantic\main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 4 validation errors for ConfusionMatrix
true_negative
  field required (type=value_error.missing)
false_positive
  field required (type=value_error.missing)
false_negative
  field required (type=value_error.missing)
true_positive
  field required (type=value_error.missing)
2025-04-06 18:33:55,952 - src.app.main - INFO - Starting model retraining process
2025-04-06 18:34:00,419 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 18:34:00,440 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 18:34:00,441 - src.app.main - INFO - X_train shape: (48715, 8), dtype: float32
2025-04-06 18:34:00,441 - src.app.main - INFO - y_train shape: (48715,), dtype: int32
2025-04-06 18:34:00,444 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 18:34:00,445 - src.app.main - INFO - Number of classes: 5
2025-04-06 18:34:00,447 - src.app.main - INFO - X_train min/max: -3.074867010116577, 5.0
2025-04-06 18:34:00,447 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 18:37:43,763 - root - INFO - 
Model Evaluation:
2025-04-06 18:37:43,763 - root - INFO - Accuracy: 0.976
2025-04-06 18:37:43,763 - root - INFO - Precision: 0.958
2025-04-06 18:37:43,763 - root - INFO - Recall: 0.9891
2025-04-06 18:37:43,764 - root - INFO - F1 Score: 0.9725
2025-04-06 18:37:43,764 - root - INFO - Confusion Matrix:
[[2361   68    7    0    0]
 [   0 2374   44   14    0]
 [   0    0  384    0    0]
 [   0    0    0  201    0]
 [   0    0    0    0   99]]
2025-04-06 18:37:43,822 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 18:38:41,765 - src.app.main - INFO - Starting model save operation
2025-04-06 18:38:41,767 - src.app.main - ERROR - Missing model_id in save request
2025-04-06 18:38:41,767 - src.app.main - ERROR - HTTP Exception during model save: Missing model_id
2025-04-06 18:39:28,667 - src.app.main - INFO - Starting model save operation
2025-04-06 18:39:28,668 - src.app.main - ERROR - Missing model_id in save request
2025-04-06 18:39:28,668 - src.app.main - ERROR - HTTP Exception during model save: Missing model_id
2025-04-06 18:50:17,758 - src.app.main - INFO - Starting model retraining process
2025-04-06 18:50:22,166 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 18:50:22,181 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 18:50:22,182 - src.app.main - INFO - X_train shape: (48715, 8), dtype: float32
2025-04-06 18:50:22,182 - src.app.main - INFO - y_train shape: (48715,), dtype: int32
2025-04-06 18:50:22,186 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 18:50:22,188 - src.app.main - INFO - Number of classes: 5
2025-04-06 18:50:22,189 - src.app.main - INFO - X_train min/max: -3.074867010116577, 5.0
2025-04-06 18:50:22,189 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 18:55:21,983 - root - INFO - 
Model Evaluation:
2025-04-06 18:55:21,985 - root - INFO - Accuracy: 0.9676
2025-04-06 18:55:21,985 - root - INFO - Precision: 0.9293
2025-04-06 18:55:21,986 - root - INFO - Recall: 0.9852
2025-04-06 18:55:21,986 - root - INFO - F1 Score: 0.9541
2025-04-06 18:55:21,987 - root - INFO - Confusion Matrix:
[[2347   79   10    0    0]
 [   0 2341   37   54    0]
 [   0    0  384    0    0]
 [   0    0    0  201    0]
 [   0    0    0    0   99]]
2025-04-06 18:55:22,159 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 18:56:00,508 - src.app.main - INFO - Starting model retraining process
2025-04-06 18:56:05,336 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 18:56:05,348 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 18:56:05,349 - src.app.main - INFO - X_train shape: (48715, 8), dtype: float32
2025-04-06 18:56:05,349 - src.app.main - INFO - y_train shape: (48715,), dtype: int32
2025-04-06 18:56:05,350 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 18:56:05,351 - src.app.main - INFO - Number of classes: 5
2025-04-06 18:56:05,352 - src.app.main - INFO - X_train min/max: -3.074867010116577, 5.0
2025-04-06 18:56:05,354 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 19:01:00,765 - root - INFO - 
Model Evaluation:
2025-04-06 19:01:00,768 - root - INFO - Accuracy: 0.9678
2025-04-06 19:01:00,768 - root - INFO - Precision: 0.9326
2025-04-06 19:01:00,769 - root - INFO - Recall: 0.9853
2025-04-06 19:01:00,769 - root - INFO - F1 Score: 0.9564
2025-04-06 19:01:00,771 - root - INFO - Confusion Matrix:
[[2343   77   16    0    0]
 [   0 2346   46   40    0]
 [   0    0  384    0    0]
 [   0    0    0  201    0]
 [   0    0    0    0   99]]
2025-04-06 19:01:00,846 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 19:01:40,964 - src.app.main - INFO - Starting model retraining process
2025-04-06 19:01:46,480 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 19:01:46,497 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 19:01:46,498 - src.app.main - INFO - X_train shape: (48715, 8), dtype: float32
2025-04-06 19:01:46,498 - src.app.main - INFO - y_train shape: (48715,), dtype: int32
2025-04-06 19:01:46,500 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 19:01:46,502 - src.app.main - INFO - Number of classes: 5
2025-04-06 19:01:46,505 - src.app.main - INFO - X_train min/max: -3.074867010116577, 5.0
2025-04-06 19:01:46,507 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 19:06:02,394 - root - INFO - 
Model Evaluation:
2025-04-06 19:06:02,395 - root - INFO - Accuracy: 0.9741
2025-04-06 19:06:02,395 - root - INFO - Precision: 0.9556
2025-04-06 19:06:02,395 - root - INFO - Recall: 0.9882
2025-04-06 19:06:02,395 - root - INFO - F1 Score: 0.9708
2025-04-06 19:06:02,396 - root - INFO - Confusion Matrix:
[[2359   67   10    0    0]
 [   9 2365   43   15    0]
 [   0    0  384    0    0]
 [   0    0    0  201    0]
 [   0    0    0    0   99]]
2025-04-06 19:06:02,445 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 19:12:30,344 - src.app.main - INFO - Starting model save operation
2025-04-06 19:12:30,345 - src.app.main - ERROR - Model not found in cache: c3a4637b-516b-4a84-b4fa-fd752d6f6103
2025-04-06 19:12:30,346 - src.app.main - ERROR - HTTP Exception during model save: Model not found or expired
2025-04-06 19:27:00,523 - src.app.main - INFO - Starting model save operation
2025-04-06 19:27:00,525 - src.app.main - ERROR - Model not found in cache: c3a4637b-516b-4a84-b4fa-fd752d6f6103
2025-04-06 19:27:00,525 - src.app.main - ERROR - HTTP Exception during model save: Model not found or expired
2025-04-06 19:29:55,379 - src.app.main - INFO - Root endpoint accessed
2025-04-06 19:30:45,223 - src.app.main - INFO - Starting training data upload
2025-04-06 19:30:50,561 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-06 19:31:00,301 - src.app.main - INFO - Starting single prediction
2025-04-06 19:31:02,575 - src.app.main - INFO - Successfully completed single prediction
2025-04-06 19:31:28,649 - src.app.main - INFO - Starting bulk prediction
2025-04-06 19:31:29,816 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 19:31:38,377 - src.app.main - INFO - Starting model retraining process
2025-04-06 19:31:38,378 - src.app.main - INFO - Generated model ID: 61331cd2-04d9-4127-bf39-be11ce7649f3
2025-04-06 19:31:45,318 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 19:31:45,424 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 19:31:45,424 - src.app.main - INFO - X_train shape: (51280, 8), dtype: float32
2025-04-06 19:31:45,449 - src.app.main - INFO - y_train shape: (51280,), dtype: int32
2025-04-06 19:31:45,455 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 19:31:45,456 - src.app.main - INFO - Number of classes: 5
2025-04-06 19:31:45,476 - src.app.main - INFO - X_train min/max: -3.07350492477417, 5.0
2025-04-06 19:31:45,477 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 19:36:49,024 - root - INFO - 
Model Evaluation:
2025-04-06 19:36:49,071 - root - INFO - Accuracy: 0.9685
2025-04-06 19:36:49,073 - root - INFO - Precision: 0.9316
2025-04-06 19:36:49,073 - root - INFO - Recall: 0.9856
2025-04-06 19:36:49,074 - root - INFO - F1 Score: 0.9556
2025-04-06 19:36:49,082 - root - INFO - Confusion Matrix:
[[2475   77   12    0    0]
 [   6 2465   33   56    0]
 [   0    0  404    0    0]
 [   0    0    0  212    0]
 [   0    0    0    0  104]]
2025-04-06 19:36:49,484 - src.app.main - INFO - Model saved successfully to C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\models\neural_network_model.h5
2025-04-06 19:40:26,007 - src.app.main - INFO - Starting model save operation
2025-04-06 19:40:26,024 - src.app.main - ERROR - Model not found in cache: 2e431229-a7e5-4c1d-9ad6-992537dbc038
2025-04-06 19:40:26,027 - src.app.main - ERROR - HTTP Exception during model save: Model not found or expired
2025-04-06 19:40:54,713 - src.app.main - INFO - Starting model save operation
2025-04-06 19:40:54,717 - src.app.main - ERROR - Model not found in cache: 2e431229-a7e5-4c1d-9ad6-992537dbc038
2025-04-06 19:40:54,717 - src.app.main - ERROR - HTTP Exception during model save: Model not found or expired
2025-04-06 20:06:28,107 - src.app.main - INFO - Root endpoint accessed
2025-04-06 20:06:49,193 - src.app.main - INFO - Starting model retraining process
2025-04-06 20:06:49,194 - src.app.main - INFO - Generated model ID: eed5a4fd-6dd5-4627-a7c0-351fb02b0c9c
2025-04-06 20:06:49,194 - src.app.main - ERROR - Unexpected error: cannot access local variable 'model' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 258, in retrain_model
    'model': model,
             ^^^^^
UnboundLocalError: cannot access local variable 'model' where it is not associated with a value
2025-04-06 20:06:51,554 - src.app.main - INFO - Starting model retraining process
2025-04-06 20:06:51,554 - src.app.main - INFO - Generated model ID: a016ca63-05f2-43a5-b028-dfab059e5d78
2025-04-06 20:06:51,554 - src.app.main - ERROR - Unexpected error: cannot access local variable 'model' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 258, in retrain_model
    'model': model,
             ^^^^^
UnboundLocalError: cannot access local variable 'model' where it is not associated with a value
2025-04-06 20:07:19,989 - src.app.main - INFO - Starting training data upload
2025-04-06 20:07:23,962 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-06 20:07:33,480 - src.app.main - INFO - Starting single prediction
2025-04-06 20:07:34,664 - src.app.main - INFO - Successfully completed single prediction
2025-04-06 20:07:37,931 - src.app.main - INFO - Starting model retraining process
2025-04-06 20:07:37,932 - src.app.main - INFO - Generated model ID: 4edfbdee-fedc-47a8-95be-e1168d1e38d6
2025-04-06 20:07:37,932 - src.app.main - ERROR - Unexpected error: cannot access local variable 'model' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 258, in retrain_model
    'model': model,
             ^^^^^
UnboundLocalError: cannot access local variable 'model' where it is not associated with a value
2025-04-06 20:08:00,681 - src.app.main - INFO - Starting bulk prediction
2025-04-06 20:08:01,427 - src.app.main - INFO - Successfully completed bulk prediction for 1022 records
2025-04-06 20:08:09,870 - src.app.main - INFO - Starting model retraining process
2025-04-06 20:08:09,870 - src.app.main - INFO - Generated model ID: 0f5acd28-a580-47b1-aa93-babcb8238c7e
2025-04-06 20:08:09,871 - src.app.main - ERROR - Unexpected error: cannot access local variable 'model' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\src\app\main.py", line 258, in retrain_model
    'model': model,
             ^^^^^
UnboundLocalError: cannot access local variable 'model' where it is not associated with a value
2025-04-06 20:14:46,375 - src.app.main - INFO - Starting model retraining process
2025-04-06 20:14:50,405 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-06 20:14:50,418 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-06 20:14:50,419 - src.app.main - INFO - X_train shape: (53845, 8), dtype: float32
2025-04-06 20:14:50,419 - src.app.main - INFO - y_train shape: (53845,), dtype: int32
2025-04-06 20:14:50,421 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-06 20:14:50,424 - src.app.main - INFO - Number of classes: 5
2025-04-06 20:14:50,424 - src.app.main - INFO - X_train min/max: -3.0688929557800293, 5.0
2025-04-06 20:14:50,425 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-06 20:16:57,220 - src.app.main - INFO - Generated model ID: 9821ff36-098c-4096-bc85-646b60d66cc6
2025-04-06 20:16:57,682 - root - INFO - 
Model Evaluation:
2025-04-06 20:16:57,682 - root - INFO - Accuracy: 0.9454
2025-04-06 20:16:57,682 - root - INFO - Precision: 0.8752
2025-04-06 20:16:57,683 - root - INFO - Recall: 0.9711
2025-04-06 20:16:57,683 - root - INFO - F1 Score: 0.9167
2025-04-06 20:16:57,683 - root - INFO - Confusion Matrix:
[[2548  108   23    0   13]
 [   6 2507  109   66    0]
 [   0   10  414    0    0]
 [   0    0    0  223    0]
 [   0    0    0    0  109]]
2025-04-06 20:16:57,723 - src.app.main - INFO - Model saved successfully to models/model_9821ff36-098c-4096-bc85-646b60d66cc6.h5
2025-04-06 20:17:44,180 - src.app.main - INFO - Starting model save operation
2025-04-06 20:17:44,231 - src.app.main - INFO - Successfully saved model to models/model_9821ff36-098c-4096-bc85-646b60d66cc6.h5
2025-04-07 07:24:37,303 - src.app.main - INFO - Root endpoint accessed
2025-04-07 07:24:58,363 - src.app.main - INFO - Starting model retraining process
2025-04-07 07:25:11,563 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-07 07:25:11,573 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-07 07:25:11,574 - src.app.main - INFO - X_train shape: (53845, 8), dtype: float32
2025-04-07 07:25:11,574 - src.app.main - INFO - y_train shape: (53845,), dtype: int32
2025-04-07 07:25:11,576 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-07 07:25:11,578 - src.app.main - INFO - Number of classes: 5
2025-04-07 07:25:11,578 - src.app.main - INFO - X_train min/max: -3.0688929557800293, 5.0
2025-04-07 07:25:11,580 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-07 07:30:14,149 - src.app.main - INFO - Generated model ID: 4a0fe5b6-0421-4990-b672-779ba0159efe
2025-04-07 07:30:15,269 - root - INFO - 
Model Evaluation:
2025-04-07 07:30:15,270 - root - INFO - Accuracy: 0.9684
2025-04-07 07:30:15,270 - root - INFO - Precision: 0.9247
2025-04-07 07:30:15,270 - root - INFO - Recall: 0.9856
2025-04-07 07:30:15,271 - root - INFO - F1 Score: 0.9501
2025-04-07 07:30:15,273 - root - INFO - Confusion Matrix:
[[2603   77    8    4    0]
 [   0 2583   19   86    0]
 [   0    0  424    0    0]
 [   0    0    0  223    0]
 [   0    0    0    0  109]]
2025-04-07 07:30:15,428 - src.app.main - INFO - Model saved successfully to models/model_4a0fe5b6-0421-4990-b672-779ba0159efe.h5
2025-04-07 07:30:58,748 - src.app.main - INFO - Starting model save operation
2025-04-07 07:30:58,824 - src.app.main - INFO - Successfully saved model to models/model_4a0fe5b6-0421-4990-b672-779ba0159efe.h5
2025-04-07 13:30:40,005 - src.app.main - INFO - Root endpoint accessed
2025-04-07 15:10:25,730 - src.app.main - INFO - Root endpoint accessed
2025-04-07 15:10:50,969 - src.app.main - INFO - Starting model retraining process
2025-04-07 15:10:55,849 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-07 15:10:55,864 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-07 15:10:55,866 - src.app.main - INFO - X_train shape: (53845, 8), dtype: float32
2025-04-07 15:10:55,868 - src.app.main - INFO - y_train shape: (53845,), dtype: int32
2025-04-07 15:10:55,870 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-07 15:10:55,873 - src.app.main - INFO - Number of classes: 5
2025-04-07 15:10:55,877 - src.app.main - INFO - X_train min/max: -3.0688929557800293, 5.0
2025-04-07 15:10:55,877 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-07 15:10:56,874 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-04-07 15:10:58,269 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

2025-04-07 15:10:58,967 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.

2025-04-07 15:12:31,429 - src.app.main - INFO - Generated model ID: 02063838-dfd4-452f-a58d-2e914a6b8c35
2025-04-07 15:12:31,838 - root - INFO - 
Model Evaluation:
2025-04-07 15:12:31,839 - root - INFO - Accuracy: 0.9521
2025-04-07 15:12:31,840 - root - INFO - Precision: 0.8893
2025-04-07 15:12:31,840 - root - INFO - Recall: 0.9781
2025-04-07 15:12:31,840 - root - INFO - F1 Score: 0.9273
2025-04-07 15:12:31,840 - root - INFO - Confusion Matrix:
[[2572   94   14    6    6]
 [   0 2514  110   64    0]
 [   0    0  424    0    0]
 [   0    0    0  223    0]
 [   0    0    0    0  109]]
2025-04-07 15:12:31,909 - src.app.main - INFO - Model saved successfully to models/model_02063838-dfd4-452f-a58d-2e914a6b8c35.h5
2025-04-07 15:17:07,666 - src.app.main - INFO - Root endpoint accessed
2025-04-07 15:17:26,567 - src.app.main - INFO - Starting model retraining process
2025-04-07 15:17:30,793 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-07 15:17:30,807 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-07 15:17:30,807 - src.app.main - INFO - X_train shape: (53845, 8), dtype: float32
2025-04-07 15:17:30,808 - src.app.main - INFO - y_train shape: (53845,), dtype: int32
2025-04-07 15:17:30,809 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-07 15:17:30,810 - src.app.main - INFO - Number of classes: 5
2025-04-07 15:17:30,811 - src.app.main - INFO - X_train min/max: -3.0688929557800293, 5.0
2025-04-07 15:17:30,811 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-07 15:17:31,169 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-04-07 15:17:32,256 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

2025-04-07 15:17:32,973 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.

2025-04-07 15:19:45,927 - src.app.main - INFO - Generated model ID: 73c56ed1-2ecb-4302-ab26-5fcd04b79c19
2025-04-07 15:19:46,324 - root - INFO - 
Model Evaluation:
2025-04-07 15:19:46,325 - root - INFO - Accuracy: 0.9661
2025-04-07 15:19:46,325 - root - INFO - Precision: 0.9255
2025-04-07 15:19:46,325 - root - INFO - Recall: 0.9845
2025-04-07 15:19:46,325 - root - INFO - F1 Score: 0.9527
2025-04-07 15:19:46,326 - root - INFO - Confusion Matrix:
[[2579   92   14    0    7]
 [   8 2593   49   38    0]
 [   0    0  424    0    0]
 [   0    0    0  223    0]
 [   0    0    0    0  109]]
2025-04-07 15:19:46,380 - src.app.main - INFO - Model saved successfully to models/model_73c56ed1-2ecb-4302-ab26-5fcd04b79c19.h5
2025-04-07 15:20:49,792 - src.app.main - INFO - Starting model save operation
2025-04-07 15:20:49,844 - src.app.main - INFO - Successfully saved model to models/model_73c56ed1-2ecb-4302-ab26-5fcd04b79c19.h5
2025-04-07 15:53:17,405 - src.app.main - INFO - Starting training data upload
2025-04-07 15:53:21,073 - src.app.main - INFO - Successfully added 1461 records, 0 invalid records
2025-04-07 15:53:32,523 - src.app.main - INFO - Starting model retraining process
2025-04-07 15:53:36,905 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.04)
2025-04-07 15:53:36,963 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-07 15:53:36,964 - src.app.main - INFO - X_train shape: (58970, 8), dtype: float32
2025-04-07 15:53:36,965 - src.app.main - INFO - y_train shape: (58970,), dtype: int32
2025-04-07 15:53:36,966 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-07 15:53:36,968 - src.app.main - INFO - Number of classes: 5
2025-04-07 15:53:36,978 - src.app.main - INFO - X_train min/max: -3.0644679069519043, 5.0
2025-04-07 15:53:36,984 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-07 15:53:37,657 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-04-07 15:53:38,522 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

2025-04-07 15:53:39,309 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.

2025-04-07 15:58:45,002 - src.app.main - INFO - Generated model ID: c3ba1cb4-aeec-47e4-abfc-0d586ce261f5
2025-04-07 15:58:46,958 - root - INFO - 
Model Evaluation:
2025-04-07 15:58:46,959 - root - INFO - Accuracy: 0.9735
2025-04-07 15:58:46,959 - root - INFO - Precision: 0.9391
2025-04-07 15:58:46,959 - root - INFO - Recall: 0.9879
2025-04-07 15:58:46,959 - root - INFO - F1 Score: 0.9613
2025-04-07 15:58:46,967 - root - INFO - Confusion Matrix:
[[2881   61    7    0    0]
 [   7 2834   56   47    0]
 [   0    0  465    0    0]
 [   0    0    0  244    0]
 [   0    0    0    0  119]]
2025-04-07 15:58:47,142 - src.app.main - INFO - Model saved successfully to models/model_c3ba1cb4-aeec-47e4-abfc-0d586ce261f5.h5
2025-04-07 20:47:12,277 - src.app.main - INFO - Starting training data upload
2025-04-07 20:47:15,334 - src.app.main - INFO - Successfully added 99 records, 0 invalid records
2025-04-07 21:57:04,313 - src.app.main - INFO - Root endpoint accessed
2025-04-07 21:57:35,261 - src.app.main - INFO - Starting training data upload
2025-04-07 21:57:37,313 - src.app.main - INFO - Successfully added 99 records, 0 invalid records
2025-04-07 21:58:45,018 - src.app.main - INFO - Starting training data upload
2025-04-07 21:58:46,712 - src.app.main - INFO - Successfully added 99 records, 0 invalid records
2025-04-07 21:58:54,084 - src.app.main - INFO - Starting single prediction
2025-04-07 21:58:57,833 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\backend.py:1398: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.

2025-04-07 21:59:00,428 - src.app.main - INFO - Successfully completed single prediction
2025-04-07 21:59:20,555 - src.app.main - INFO - Starting bulk prediction
2025-04-07 21:59:21,904 - src.app.main - INFO - Successfully completed bulk prediction for 438 records
2025-04-07 21:59:30,667 - src.app.main - INFO - Starting model retraining process
2025-04-07 21:59:37,673 - root - INFO - Applying Random Over-Sampling (imbalance ratio: 0.05)
2025-04-07 21:59:37,705 - src.app.main - INFO - 
=== DATA VALIDATION ===
2025-04-07 21:59:37,707 - src.app.main - INFO - X_train shape: (77550, 8), dtype: float32
2025-04-07 21:59:37,708 - src.app.main - INFO - y_train shape: (77550,), dtype: int32
2025-04-07 21:59:37,712 - src.app.main - INFO - Unique y_train values: [0 1 2 3 4]
2025-04-07 21:59:37,716 - src.app.main - INFO - Number of classes: 5
2025-04-07 21:59:37,717 - src.app.main - INFO - X_train min/max: -2.9957356452941895, 5.0
2025-04-07 21:59:37,717 - src.app.main - INFO - y_train min/max: 0, 4
2025-04-07 21:59:39,290 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

2025-04-07 21:59:40,483 - tensorflow - WARNING - From C:\Users\hp1\Desktop\MLOP\WeatherWise-Classifier-MLOP\venv\Lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.

2025-04-07 22:15:29,594 - src.app.main - INFO - Generated model ID: 80d656dd-b100-4bd9-ad55-42b979f4e5cc
2025-04-07 22:15:34,146 - root - INFO - 
Model Evaluation:
2025-04-07 22:15:34,147 - root - INFO - Accuracy: 0.9829
2025-04-07 22:15:34,147 - root - INFO - Precision: 0.9527
2025-04-07 22:15:34,148 - root - INFO - Recall: 0.9916
2025-04-07 22:15:34,149 - root - INFO - F1 Score: 0.9711
2025-04-07 22:15:34,161 - root - INFO - Confusion Matrix:
[[3796   67    0    4   10]
 [   0 3706   25   43    0]
 [   0    0  586    0    0]
 [   0    1    0  317    0]
 [   0    0    0    0  196]]
2025-04-07 22:15:34,823 - src.app.main - INFO - Model saved successfully to models/model_80d656dd-b100-4bd9-ad55-42b979f4e5cc.h5
